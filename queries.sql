-- VIEWS
-- 1)
CREATE VIEW CUSTOMER_V AS
SELECT PFIRSTNAME AS 'FIRST NAME', PLASTNAME AS 'LAST NAME', 'Premier' AS `Customer Type`,  (YEAR(CURDATE())-YEAR(PDATEJOINED)) AS 'YEARS WITH US'
FROM PRIVATEINDIVIDUAL
INNER JOIN PREMIERCUSTOMER ON PREMIERCUSTOMER.CID = PRIVATEINDIVIDUAL.CID
UNION
SELECT PFIRSTNAME AS 'FIRST NAME', PLASTNAME AS 'LAST NAME', 'Steady' AS `Customer Type`,  (YEAR(CURDATE())-YEAR(PDATEJOINED)) AS 'YEARS WITH US'
FROM PRIVATEINDIVIDUAL
INNER JOIN STEADYCUSTOMER ON STEADYCUSTOMER.CID = PRIVATEINDIVIDUAL.CID
UNION
SELECT PFIRSTNAME AS 'FIRST NAME', PLASTNAME AS 'LAST NAME', 'Prospective' AS `Customer Type`,  (YEAR(CURDATE())-YEAR(PDATEJOINED)) AS 'YEARS WITH US'
FROM PRIVATEINDIVIDUAL
INNER JOIN PROSPECTIVECUSTOMER ON PROSPECTIVECUSTOMER.CID = PRIVATEINDIVIDUAL.CID
UNION
SELECT CORPNAME AS 'FIRST NAME', '' AS 'LAST NAME', 'Premier' AS `Customer Type`,  (YEAR(CURDATE())-YEAR(DATEJOINED)) AS 'YEARS WITH US'
FROM CORPORATION
INNER JOIN PREMIERCUSTOMER ON PREMIERCUSTOMER.CID = CORPORATION.CID
UNION
SELECT CORPNAME AS 'FIRST NAME', '' AS 'LAST NAME', 'Steady' AS `Customer Type`,  (YEAR(CURDATE())-YEAR(DATEJOINED)) AS 'YEARS WITH US'
FROM CORPORATION
INNER JOIN STEADYCUSTOMER ON STEADYCUSTOMER.CID = CORPORATION.CID
UNION
SELECT CORPNAME AS 'FIRST NAME', '' AS 'LAST NAME', 'Prospective' AS `Customer Type`,  (YEAR(CURDATE())-YEAR(DATEJOINED)) AS 'YEARS WITH US'
FROM CORPORATION
INNER JOIN PROSPECTIVECUSTOMER ON PROSPECTIVECUSTOMER.CID = CORPORATION.CID;
-- 2)
CREATE VIEW CUSTOMER_ADDRESSES_V AS
SELECT 'Corporation' AS `ACCOUNT TYPE`, CorpName AS FIRSTNAME, '' AS LASTNAME, 'Corporate' as `Address Type`, MAILING_ADDRESS AS MAILING, BILLING_ADDRESS AS BILLING, VEHICLE_PICKUP AS PICKUP, VEHICLE_DROPOFF AS DROPOFF
FROM CORPORATION
UNION
SELECT 'Individual' AS `ACCOUNT TYPE`, PFIRSTNAME AS FIRSTNAME, PLASTNAME AS LASTNAME, 'Private' as `Address Type`, PADDRESS AS MAILING, '' AS BILLING,''AS PICKUP,''AS DROPOFF
FROM PRIVATEINDIVIDUAL;

-- 3)
CREATE VIEW PREMIER_PROFIT_V AS
SELECT PFIRSTNAME, PLASTNAME, PREMIERCUSTOMER.CID, PREMIERYEAR - (DISPLAY * 50) AS PREMIERTOTAL, STEADYCOST, STEADYCOST - (PREMIERYEAR - (DISPLAY * 50)) AS PROFIT
FROM (SELECT PFIRSTNAME, PLASTNAME,PREMIERCUSTOMER.CID, 
COUNT(DISTINCT REFERREDCUSTOMERINSTANCE.CID) AS DISPLAY, ANNUALFEE * 12 AS PREMIERYEAR, ORDER_DATE, SUM(ITEMCOST) AS STEADYCOST, ORDER_ID
FROM CUSTOMER
LEFT OUTER JOIN REFERREDCUSTOMERINSTANCE ON CUSTOMER.CID = REFERREDCUSTOMERINSTANCE.CID
RIGHT OUTER JOIN PRIVATEINDIVIDUAL ON CUSTOMER.CID = PRIVATEINDIVIDUAL.CID
RIGHT OUTER JOIN PREMIERCUSTOMER ON CUSTOMER.CID = PREMIERCUSTOMER.CID
INNER JOIN VEHICLE  ON ( CUSTOMER.CID = VEHICLE.cID)
INNER JOIN `ORDER` USING (VIN)
INNER JOIN MAINTENANCE_DETAILS  USING (ORDER_ID)
INNER JOIN MAINTENANCE_ITEM  ON (MAINTENANCE_DETAILS.ITEM_NAME =MAINTENANCE_ITEM.ITEM_NAME  
AND MAINTENANCE_DETAILS.AUTOMOBILE_ID = MAINTENANCE_ITEM.AUTOMOBILE_ID)
WHERE ORDER_DATE BETWEEN DATE_SUB(CURDATE(),INTERVAL 1 YEAR) AND now()
GROUP BY PREMIERCUSTOMER.CID) G
NATURAL JOIN PREMIERCUSTOMER
WHERE PREMIERCUSTOMER.CID = G.CID
ORDER BY PROFIT DESC;

-- 4)
CREATE VIEW MECHANIC_MENTOR_V AS
SELECT A.EMPLOYEENAME AS MENTOR, B.EMPLOYEENAME AS MENTEE, MSTARTDATE, MSKILL
FROM (SELECT EMPLOYEENAME,MSTARTDATE,MSKILL FROM MENTORING 
INNER JOIN EMPLOYEE ON MENTORING.MENTORID = EMPLOYEE.EMPLOYEEID) A
INNER JOIN
(SELECT EMPLOYEENAME,MSTARTDATE,MSKILL FROM MENTORING
INNER JOIN EMPLOYEE ON MENTORING.MENTOREEID = EMPLOYEE.EMPLOYEEID) B
USING (MSTARTDATE,MSKILL)
ORDER BY MENTOR, MENTEE;


-- 5)
CREATE VIEW PROSPECTIVE_RESURRECTION_V AS
SELECT PFIRSTNAME AS FIRSTNAME, PLASTNAME AS LASTNAME, SPECIALDATE AS PREIVOUSCONTACTDATE FROM PRIVATEINDIVIDUAL INNER JOIN CUSTOMER ON PRIVATEINDIVIDUAL.cid = CUSTOMER.cid
INNER JOIN PROSPECTIVECUSTOMER ON CUSTOMER.cid = PROSPECTIVECUSTOMER.cid 
INNER JOIN SPECIAL ON PROSPECTIVECUSTOMER.CID = SPECIAL.CID
WHERE PROSPECTIVECUSTOMER.timescontacted >=3 AND DATE_SUB(CURDATE(), INTERVAL 1 YEAR) > (SELECT MAX(SPECIALDATE)) >=1
UNION
SELECT CORPNAME AS FIRSTNAME, '' AS PLASTNAME, SPECIALDATE AS PREIVOUSCONTACTDATE FROM CORPORATION INNER JOIN CUSTOMER ON CORPORATION.cid = CUSTOMER.cid
INNER JOIN PROSPECTIVECUSTOMER ON CUSTOMER.cid = PROSPECTIVECUSTOMER.cid 
INNER JOIN SPECIAL ON PROSPECTIVECUSTOMER.CID = SPECIAL.CID
WHERE PROSPECTIVECUSTOMER.timescontacted >=3 AND DATE_SUB(CURDATE(), INTERVAL 1 YEAR) > (SELECT MAX(SPECIALDATE)) >=1;






-- QUERIES
-- 1
SELECT CONCAT(PFIRSTNAME, PLASTNAME) AS CUSTOMERNAME, 'PRIVATE INDIVIDUAL' AS CUSTOMERTYPE,
CEMAIL, CPHONE
FROM CUSTOMER 
NATURAL JOIN PRIVATEINDIVIDUAL
UNION
SELECT CORPNAME AS CUSTOMERNAME,'CORPORATE' AS CUSTOMERTYPE,CEMAIL, CPHONE
FROM CUSTOMER
NATURAL JOIN CORPORATION;

-- 2
SELECT GROUP_CONCAT(PFIRSTNAME,PLASTNAME) AS `NAME`, ORDER_DATE, SUM(ITEMCOST) AS TOTALCOST
FROM CUSTOMER
INNER JOIN PRIVATEINDIVIDUAL ON CUSTOMER.CID = PRIVATEINDIVIDUAL.CID 
INNER JOIN VEHICLE  ON ( CUSTOMER.CID = VEHICLE.cID)
INNER JOIN `ORDER` USING (VIN)
INNER JOIN MAINTENANCE_DETAILS  USING (ORDER_ID)
INNER JOIN MAINTENANCE_ITEM  ON (MAINTENANCE_DETAILS.ITEM_NAME =MAINTENANCE_ITEM.ITEM_NAME  AND MAINTENANCE_DETAILS.AUTOMOBILE_ID = MAINTENANCE_ITEM.AUTOMOBILE_ID)
GROUP BY CUSTOMER.CID,ORDER_ID,MAINTENANCE_ITEM.AUTOMOBILE_ID,MAINTENANCE_ITEM.ITEM_NAME
UNION
SELECT CORPNAME AS `NAME`, ORDER_DATE, SUM(ITEMCOST) AS TOTALCOST
FROM CUSTOMER
INNER JOIN CORPORATION ON CUSTOMER.CID = CORPORATION.CID 
INNER JOIN VEHICLE  ON ( CUSTOMER.CID = VEHICLE.cID)
INNER JOIN `ORDER` USING (VIN)
INNER JOIN MAINTENANCE_DETAILS  USING (ORDER_ID)
INNER JOIN MAINTENANCE_ITEM  ON (MAINTENANCE_DETAILS.ITEM_NAME =MAINTENANCE_ITEM.ITEM_NAME  AND MAINTENANCE_DETAILS.AUTOMOBILE_ID = MAINTENANCE_ITEM.AUTOMOBILE_ID)
GROUP BY CUSTOMER.CID,ORDER_ID,MAINTENANCE_ITEM.AUTOMOBILE_ID,MAINTENANCE_ITEM.ITEM_NAME;

-- 3
SELECT CUSTOMERNAME ,CUSTOMER.CID, SUM(TOTALCOST) AS NETCOST
FROM(SELECT CONCAT(PFIRSTNAME, PLASTNAME) AS CUSTOMERNAME, CUSTOMER.CID, ORDER_DATE,SUM(ITEMCOST) AS TOTALCOST, SUM(LOYALTY_POINTS_SPENT * 5) AS POINTS
FROM CUSTOMER
INNER JOIN PRIVATEINDIVIDUAL ON CUSTOMER.CID = PRIVATEINDIVIDUAL.CID
LEFT OUTER JOIN STEADY_CUSTOMER_ORDER_DETAILS ON CUSTOMER.CID = STEADY_CUSTOMER_ORDER_DETAILS.CID
INNER JOIN VEHICLE  ON ( CUSTOMER.CID = VEHICLE.cID)
INNER JOIN `ORDER` USING (VIN)
INNER JOIN MAINTENANCE_DETAILS  ON `ORDER`.ORDER_ID = MAINTENANCE_DETAILS.ORDER_ID
INNER JOIN MAINTENANCE_ITEM  ON (MAINTENANCE_DETAILS.ITEM_NAME =MAINTENANCE_ITEM.ITEM_NAME  AND MAINTENANCE_DETAILS.AUTOMOBILE_ID = MAINTENANCE_ITEM.AUTOMOBILE_ID)
WHERE `ORDER`.ORDER_DATE BETWEEN DATE_SUB(CURDATE(),INTERVAL 2 YEAR) AND now()
GROUP BY CUSTOMER.CID, MAINTENANCE_DETAILS.ORDER_ID,MAINTENANCE_ITEM.AUTOMOBILE_ID,MAINTENANCE_ITEM.ITEM_NAME
UNION
SELECT CORPNAME AS CUSTOMERNAME, CUSTOMER.CID, ORDER_DATE,SUM(ITEMCOST) AS TOTALCOST, SUM(LOYALTY_POINTS_SPENT * 5) AS POINTS
FROM CUSTOMER
INNER JOIN CORPORATION ON CUSTOMER.CID = CORPORATION.CID
LEFT OUTER JOIN STEADY_CUSTOMER_ORDER_DETAILS ON CUSTOMER.CID = STEADY_CUSTOMER_ORDER_DETAILS.CID
INNER JOIN VEHICLE  ON ( CUSTOMER.CID = VEHICLE.cID)
INNER JOIN `ORDER` USING (VIN)
INNER JOIN MAINTENANCE_DETAILS  ON `ORDER`.ORDER_ID = MAINTENANCE_DETAILS.ORDER_ID
INNER JOIN MAINTENANCE_ITEM  ON (MAINTENANCE_DETAILS.ITEM_NAME =MAINTENANCE_ITEM.ITEM_NAME  AND MAINTENANCE_DETAILS.AUTOMOBILE_ID = MAINTENANCE_ITEM.AUTOMOBILE_ID)
WHERE `ORDER`.ORDER_DATE BETWEEN DATE_SUB(CURDATE(),INTERVAL 2 YEAR) AND now()
GROUP BY CUSTOMER.CID, MAINTENANCE_DETAILS.ORDER_ID,MAINTENANCE_ITEM.AUTOMOBILE_ID,MAINTENANCE_ITEM.ITEM_NAME) G
NATURAL JOIN CUSTOMER
WHERE CID = G.CID
GROUP BY CUSTOMER.CID
ORDER BY NETCOST DESC LIMIT 3;

-- 4
SELECT EMPLOYEENAME, GROUP_CONCAT(SKILLNAME2),COUNT(SKILLNAME2) as skillspossess
FROM EMPLOYEE
INNER JOIN MECHANIC ON EMPLOYEE.EMPLOYEEID = EMPLOYEEID2
INNER JOIN SKILLDETAILS ON SKILLDETAILS.EMPLOYEEID3 = MECHANIC.EMPLOYEEID2
GROUP BY EMPLOYEEID HAVING COUNT(SKILLNAME2) >=3;

-- 5
SELECT A.EMPLOYEENAME AS MECHANICA, B.EMPLOYEENAME AS MECHANICB, GROUP_CONCAT(SKILLNAME2) AS COMMONSKILLS
FROM ( SELECT EMPLOYEENAME, SKILLNAME2 FROM SKILLDETAILS
INNER JOIN EMPLOYEE ON SKILLDETAILS.EMPLOYEEID3 = EMPLOYEE.EMPLOYEEID) A
INNER JOIN
(SELECT EMPLOYEENAME, SKILLNAME2 FROM SKILLDETAILS
INNER JOIN EMPLOYEE ON SKILLDETAILS.EMPLOYEEID3 = EMPLOYEE.EMPLOYEEID) B 
USING (SKILLNAME2)
WHERE A.EMPLOYEENAME < B.EMPLOYEENAME
GROUP BY A.EMPLOYEENAME, B.EMPLOYEENAME
HAVING COUNT(SKILLNAME2) >= 3;

-- 6
SELECT MPACKTYPE, GROUP_CONCAT(DISTINCT MAINTENANCE_PACK_DETAILS.ITEM_NAME) AS ITEMS, SUM(ITEMCOST) AS TOTAL
FROM MAINTENANCE_PACK_DETAILS
INNER JOIN MAINTENANCE_ITEM ON (MAINTENANCE_ITEM.ITEM_NAME = MAINTENANCE_PACK_DETAILS.ITEM_NAME 
AND MAINTENANCE_ITEM.AUTOMOBILE_ID = MAINTENANCE_PACK_DETAILS.AUTOMOBILE_ID)
GROUP BY MPACKTYPE;

-- 7

-- 8
SELECT PFIRSTNAME AS FIRSTNAME, PLASTNAME AS LASTNAME , LOYALTYPOINTS
FROM CUSTOMER
NATURAL JOIN PRIVATEINDIVIDUAL
NATURAL JOIN ACTIVE
NATURAL JOIN STEADYCUSTOMER
UNION
SELECT CORPNAME AS FIRSTNAME, '' AS LASTNAME, LOYALTYPOINTS
FROM CUSTOMER
NATURAL JOIN CORPORATION
NATURAL JOIN ACTIVE
NATURAL JOIN STEADYCUSTOMER
ORDER BY LOYALTYPOINTS DESC;

-- 9
SELECT PFIRSTNAME, PLASTNAME, PREMIERCUSTOMER.CID, YEARTOTAL - (DISPLAY * 50) AS YEARLYTOTAL, TOTALCOST, TOTALCOST - (YEARTOTAL - (DISPLAY * 50)) AS TOTALSAVED
FROM (SELECT PFIRSTNAME, PLASTNAME,PREMIERCUSTOMER.CID, 
COUNT(DISTINCT REFERREDCUSTOMERINSTANCE.CID) AS DISPLAY, ANNUALFEE * 12 AS YEARTOTAL, ORDER_DATE, SUM(ITEMCOST) AS TOTALCOST, ORDER_ID, CONCAT(MAINTENANCE_DETAILS.ITEM_NAME)
FROM CUSTOMER
LEFT OUTER JOIN REFERREDCUSTOMERINSTANCE ON CUSTOMER.CID = REFERREDCUSTOMERINSTANCE.CID
RIGHT OUTER JOIN PRIVATEINDIVIDUAL ON CUSTOMER.CID = PRIVATEINDIVIDUAL.CID
RIGHT OUTER JOIN PREMIERCUSTOMER ON CUSTOMER.CID = PREMIERCUSTOMER.CID
INNER JOIN VEHICLE  ON ( CUSTOMER.CID = VEHICLE.cID)
INNER JOIN `ORDER` USING (VIN)
INNER JOIN MAINTENANCE_DETAILS  USING (ORDER_ID)
INNER JOIN MAINTENANCE_ITEM  ON (MAINTENANCE_DETAILS.ITEM_NAME =MAINTENANCE_ITEM.ITEM_NAME  
AND MAINTENANCE_DETAILS.AUTOMOBILE_ID = MAINTENANCE_ITEM.AUTOMOBILE_ID)
WHERE ORDER_DATE BETWEEN DATE_SUB(CURDATE(),INTERVAL 1 YEAR) AND now()
GROUP BY PREMIERCUSTOMER.CID) G
NATURAL JOIN PREMIERCUSTOMER
WHERE PREMIERCUSTOMER.CID = G.CID
ORDER BY TOTALSAVED DESC;

-- 10
SELECT CUSTOMERNAME,CORPNAME,STEADYCUSTOMER.CID, SUM(TOTALCOST) AS NETSPENDING, SUM(SHOPCOST),  SUM(TOTALCOST) - SUM(SHOPCOST)   AS PROFIT
FROM (SELECT CONCAT(PFIRSTNAME, PLASTNAME) AS CUSTOMERNAME,CORPNAME,CUSTOMER.CID, ORDER_DATE, SUM(ITEMCOST) AS TOTALCOST, SUM(BUYPRICE) AS SHOPCOST
FROM CUSTOMER
LEFT  JOIN STEADYCUSTOMER ON CUSTOMER.CID = STEADYCUSTOMER.CID 
LEFT  JOIN PRIVATEINDIVIDUAL ON CUSTOMER.CID = PRIVATEINDIVIDUAL.CID
LEFT  JOIN CORPORATION ON CUSTOMER.CID = CORPORATION.CID
INNER JOIN VEHICLE  ON ( CUSTOMER.CID = VEHICLE.cID)
INNER JOIN `ORDER` USING (VIN)
INNER JOIN MAINTENANCE_DETAILS  USING (ORDER_ID)
INNER JOIN MAINTENANCE_ITEM  ON (MAINTENANCE_DETAILS.ITEM_NAME =MAINTENANCE_ITEM.ITEM_NAME  AND MAINTENANCE_DETAILS.AUTOMOBILE_ID = MAINTENANCE_ITEM.AUTOMOBILE_ID)
WHERE `ORDER`.ORDER_DATE BETWEEN DATE_SUB(CURDATE(),INTERVAL 1 YEAR) AND now()
GROUP BY CUSTOMER.CID,ORDER_ID,MAINTENANCE_ITEM.AUTOMOBILE_ID,MAINTENANCE_ITEM.ITEM_NAME,MAINTENANCE_ITEM.BUYPRICE)G
NATURAL JOIN STEADYCUSTOMER
WHERE STEADYCUSTOMER.CID = G.CID
GROUP BY STEADYCUSTOMER.CID
ORDER BY NETSPENDING DESC;

-- 11
SELECT PFIRSTNAME AS FIRSTNAME, PLASTNAME AS LASTNAME, PREMIERCUSTOMER.CID AS ID, YEARTOTAL, YEARTOTAL - (DISPLAY * 50) AS ACTUALPAYMENT
FROM (SELECT PFIRSTNAME, PLASTNAME,PREMIERCUSTOMER.CID, COUNT(DISTINCT REFERREDCUSTOMERINSTANCE.CID) AS DISPLAY, ANNUALFEE * 12 AS YEARTOTAL
FROM CUSTOMER
INNER JOIN REFERREDCUSTOMERINSTANCE ON CUSTOMER.CID = REFERREDCUSTOMERINSTANCE.CID
INNER JOIN PRIVATEINDIVIDUAL ON CUSTOMER.CID = PRIVATEINDIVIDUAL.CID
INNER JOIN PREMIERCUSTOMER ON CUSTOMER.CID = PREMIERCUSTOMER.CID
GROUP BY PREMIERCUSTOMER.CID) G
NATURAL JOIN PREMIERCUSTOMER
WHERE PREMIERCUSTOMER.CID = G.CID
UNION
SELECT CORPNAME AS FIRSTNAME, '' AS LASTNAME, PREMIERCUSTOMER.CID AS ID, YEARTOTAL, YEARTOTAL - (DISPLAY * 50) AS ACTUALPAYMENT
FROM (SELECT CORPNAME,PREMIERCUSTOMER.CID, COUNT(DISTINCT REFERREDCUSTOMERINSTANCE.CID) AS DISPLAY, ANNUALFEE * 12 AS YEARTOTAL
FROM CUSTOMER
LEFT OUTER JOIN REFERREDCUSTOMERINSTANCE ON CUSTOMER.CID = REFERREDCUSTOMERINSTANCE.CID
INNER JOIN CORPORATION ON CUSTOMER.CID = CORPORATION.CID
INNER JOIN PREMIERCUSTOMER ON CUSTOMER.CID = PREMIERCUSTOMER.CID
GROUP BY PREMIERCUSTOMER.CID) G
NATURAL JOIN PREMIERCUSTOMER
WHERE PREMIERCUSTOMER.CID = G.CID
ORDER BY YEARTOTAL DESC
LIMIT 3;

-- 12
SELECT VMODEL, VMAKE, VYEAR, COUNT(MANUFACTURER.AUTOMOBILE_ID) AS TIMESVISTED
FROM MANUFACTURER
INNER JOIN VEHICLE ON MANUFACTURER.AUTOMOBILE_ID = VEHICLE.AUTOMOBILE_ID
INNER JOIN `ORDER` ON VEHICLE.VIN = `ORDER`.VIN
WHERE ORDER_DATE BETWEEN DATE_SUB(CURDATE(),INTERVAL 3 YEAR) AND now()
GROUP BY MANUFACTURER.AUTOMOBILE_ID
ORDER BY COUNT(MANUFACTURER.AUTOMOBILE_ID) DESC
LIMIT 5;

-- 13
SELECT EMPLOYEENAME AS MENTOR, GROUP_CONCAT(DISTINCT MSKILL), COUNT(mentorID) AS TIMESMENTORED
FROM EMPLOYEE
INNER JOIN MECHANIC ON EMPLOYEE.EMPLOYEEID = MECHANIC.EMPLOYEEID2
INNER JOIN MENTORING ON MECHANIC.EMPLOYEEID2 = MENTORING.MENTORID
GROUP BY MENTOR
ORDER BY COUNT(mentoreeID) DESC
LIMIT 1;

-- 14
SELECT SKILLNAME, MECHANICS
FROM(SELECT SKILLNAME,  COUNT(EMPLOYEEID2) AS MECHANICS
FROM SKILLS 
INNER JOIN SKILLDETAILS ON SKILLS.SKILLNAME = SKILLDETAILS.SKILLNAME2
INNER JOIN MECHANIC ON MECHANIC.EMPLOYEEID2 = SKILLDETAILS.EMPLOYEEID3
GROUP BY SKILLNAME HAVING COUNT(EMPLOYEEID2)
ORDER BY MECHANICS ASC LIMIT 3) G
WHERE SKILLNAME = G.SKILLNAME;

-- 15
SELECT EMPLOYEENAME, MECHANIC.EMPLOYEEID2 AS MECHANICID, TECHNICIAN.EMPLOYEEID AS TECHNICIANID
FROM EMPLOYEE INNER JOIN MECHANIC ON EMPLOYEE.EMPLOYEEID = MECHANIC.EMPLOYEEID2
INNER JOIN TECHNICIAN ON EMPLOYEE.EMPLOYEEID = TECHNICIAN.EMPLOYEEID;

-- 16a
SELECT EMPLOYEENAME, SKILLNAME2, timestampdiff(year, DATELEARNED, curdate()) AS 'EXP TIME'
FROM EMPLOYEE AS EM
INNER JOIN MECHANIC AS M ON EM.EMPLOYEEID = M.EMPLOYEEID2
INNER JOIN SKILLDETAILS AS SD ON M.EMPLOYEEID2 = SD.EMPLOYEEID3;

-- 16b
SELECT VMAKE, VMODEL, VYEAR,VTYPE, COUNT(MPACKTYPE) AS SERVICEPACK,
COUNT(ITEM_NAME) AS MAINTENANCEITEM, COUNT(CID) AS CUSTOMER
FROM MANUFACTURER M
LEFT JOIN MAINTENANCE_PACK MP ON(M.AUTOMOBILE_ID = MP.AUTOMOBILE_ID)
LEFT JOIN MAINTENANCE_ITEM MI ON(M.AUTOMOBILE_ID = MI.AUTOMOBILE_ID)
LEFT JOIN VEHICLE V ON M.AUTOMOBILE_ID =V.AUTOMOBILE_ID
WHERE VTYPE = 'Electric' ;

-- 16c
SELECT EMPLOYEENAME, COUNT(DISTINCT ORD.EMPLOYEE_ID) AS 'NUMBER OF ITEMS WORKING ON', ORD.ORDER_ID,
ORD.ORDER_DATE, ITEM_NAME
FROM `ORDER` AS ORD
INNER JOIN EMPLOYEE ON EMPLOYEE.EMPLOYEEID
INNER JOIN MAINTENANCE_DETAILS ON ORD.ORDER_ID = MAINTENANCE_DETAILS.ORDER_ID
GROUP BY ORDER_ID;
